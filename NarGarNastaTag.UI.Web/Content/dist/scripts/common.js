!function(t){function e(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var o=window.webpackJsonp;window.webpackJsonp=function(i,a){for(var u,s,d=0,p=[];d<i.length;d++)s=i[d],n[s]&&p.push.apply(p,n[s]),n[s]=0;for(u in a)t[u]=a[u];for(o&&o(i,a);p.length;)p.shift().call(null,e);return a[0]?(r[0]=0,e(0)):void 0};var r={},n={4:0};e.e=function(t,o){if(0===n[t])return o.call(null,e);if(void 0!==n[t])n[t].push(o);else{n[t]=[o];var r=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.async=!0,i.src=e.p+""+t+"."+({0:"routes",1:"train",2:"favorites",3:"home"}[t]||t)+".page.js",r.appendChild(i)}},e.m=t,e.c=r,e.p="Content/dist"}([,function(t,exports,e){var o=function(){function t(){}return t.getQueryStringParameterByName=function(t,e){var o=RegExp("[?&]"+e+"=([^&]*)").exec(t);return o&&o[1].replace(/\+/g," ")},t}();t.exports=o},function(t,exports,e){t.exports=$},function(t,exports,e){(function($){var o=(e(7),e(8)),r=e(4),n=function(){function t(){o.setup(),this.repository=o.resolve("IRouteRepository"),this.idGenerator=o.resolve("IGenerateId"),this.routeHandler=o.resolve("IKnowFavouriteRoutes"),this.remoteQueryExecutor=o.resolve("IQueryRemoteRoutes"),this.apiUrl=window.apiUrl}return t.prototype.add=function(t,e,o,n,i){var a=new r;a.routeId=this.idGenerator.getId(),a.from.id=e.toUpperCase(),a.from.name=t,a.to.id=n.toUpperCase(),a.to.name=o,a.to.id=n;var u=this;this.routeHandler.add(a,function(){u.repository.saveAll(u.routeHandler.favouriteRoutes),i&&i()})},t.prototype.remove=function(t,e,o){var r=this;this.routeHandler.remove(e,t,function(){r.repository.saveAll(r.routeHandler.favouriteRoutes),o&&o()})},t.prototype.getRoutes=function(){var t=[];if(this.routeHandler.cache(this.repository.readAll()),!this.routeHandler.favouriteRoutes||0===this.routeHandler.favouriteRoutes.length)return t;try{this.routeHandler.favouriteRoutes.forEach(function(e){e.to.forEach(function(o){var n=new r;n.routeId=o.routeId,n.to.id=o.id,n.to.name=o.name,n.from.id=e.from.id,n.from.name=e.from.name,t.push(n)})})}catch(e){this.repository.remove()}return t},t.prototype.queryRemote=function(t,e,o){t&&e&&this.remoteQueryExecutor.query($,t,e,function(r){var n={data:r,url:t,xpath:e};o&&o(n)})},t.prototype.scrapeStations=function(t){this.doAjax(this.apiUrl+"/query/stations",function(e){var o={data:e};t&&t(o)})},t.prototype.scrapeStationRoutes=function(t,e){this.doAjax(this.apiUrl+"/query/station/"+t,function(t){var o={data:t};e&&e(o)})},t.prototype.doAjax=function(t,e){$.support.cors=!0,$.ajax({url:t,type:"GET",dataType:"json",cache:!1,success:function(t){e(t)}})},t.prototype.getApiUrl=function(){return this.apiUrl},t}();t.exports=n}).call(exports,e(2))},function(t,exports,e){var o=function(){function t(){this.from={name:"",id:""},this.to={name:"",id:""}}return t}();t.exports=o},function(t,exports,e){var o=function(){function t(){}return t.prototype.log=function(t,e){window.console&&console.log&&console.log({clearText:t,error:e})},t.prototype.inform=function(t){window.console&&console.log&&console.log({clearText:t})},t.prototype.dump=function(t){window.console&&console.log&&console.log(t)},t}();t.exports=o},,function(t,exports,e){},function(t,exports,e){var o=e(10),r=e(11),n=e(12),i=e(9),a=e(13),u=e(14),s=function(){function t(){}return t.register=function(e,o){return t.container||(t.container=[]),t.container.push({_interfaceType:e,_type:o}),o},t.resolve=function(e){for(var o=0;o<t.container.length;o++)if(t.container[o]._interfaceType===e)return t.container[o]._type;throw new Error(e+" is not registred.")},t.setup=function(){var e=(t.register("IGenerateId",new o),t.register("IParseRoutes",new r(JSON))),s=t.register("IStationRoutes",[]),d=t.register("IConfigureCookieStore",new n("NT_FAVOURITE_ROUTES",365,e)),p=t.register("IRouteRepository",new i(d,e));t.register("IKnowFavouriteRoutes",new a(p,s)),t.register("IQueryRemoteRoutes",new u)},t}();t.exports=s},function(t,exports,e){var o=function(){function t(t,e){this.configuration=t,this.parser=e}return t.prototype.saveAll=function(t){var e=this.parser.serialize(t),o=new Date;o.setDate(o.getDate()+this.configuration.expiryInDays);var r=escape(e)+(null===this.configuration.expiryInDays?"":"; expires="+o.toUTCString());document.cookie=this.configuration.cookieName+"="+r},t.prototype.readAll=function(){for(var t=document.cookie.split(";"),e=0;e<t.length;e++){var o=t[e].substr(0,t[e].indexOf("=")),r=t[e].substr(t[e].indexOf("=")+1);if(o=o.replace(/^\s+|\s+$/g,""),o===this.configuration.cookieName){var n=unescape(r);return n?this.parser.deserialize(n):void 0}}},t.prototype.remove=function(){var t=new Date;t.setDate(t.getDate()-1);var e="; expires="+t.toUTCString();document.cookie=this.configuration.cookieName+"="+e},t}();t.exports=o},function(t,exports,e){var o=function(){function t(){}return t.prototype.getId=function(){var t=(new Date).getTime(),e=1+Math.floor(32767*Math.random()),o=1+Math.floor(32767*Math.random());return t+"-"+e+"-"+o},t.prototype.getRandomRangedInteger=function(t,e){return Math.floor(Math.random()*(1+e-t))+t},t}();t.exports=o},function(t,exports,e){var o=e(5),r=function(){function t(t){this.parser=t}return t.prototype.serialize=function(t){return t?this.parser.stringify(t):""},t.prototype.deserialize=function(t){try{var e=JSON.parse(t);return e}catch(r){var n=new o;n.log("Cannot deserialize routes.",r)}},t}();t.exports=r},function(t,exports,e){var o=function(){function t(t,e,o){this.cookieName=t,this.expiryInDays=e,this.mapper=o}return t}();t.exports=o},function(t,exports,e){var o=e(15),r=function(){function t(t,e){this.repository=t,this.favouriteRoutes=e}return t.prototype.cache=function(t){this.favouriteRoutes=t},t.prototype.add=function(t,e){var r,n,i,a=t.from.id.toUpperCase(),u=t.to.id.toUpperCase();if(this.favouriteRoutes)for(var s=this.favouriteRoutes.length-1;s>=0;s--)if(this.favouriteRoutes[s].from.id.toUpperCase()===a){r=!0,n=s;break}if(r){for(var s=this.favouriteRoutes[n].to.length-1;s>=0;s--){var d=this.favouriteRoutes[n].to[s].id.toUpperCase();if(d===u)return}var p={routeId:t.routeId,name:t.to.name,id:u};this.favouriteRoutes[n].to.push(p),i=!0}else{var f=new o;f.from.name=t.from.name,f.from.id=t.from.id,f.to[0].routeId=t.routeId,f.to[0].name=t.to.name,f.to[0].id=u,this.favouriteRoutes||(this.favouriteRoutes=[]),this.favouriteRoutes.push(f),i=!0}e&&i&&e()},t.prototype.remove=function(t,e,o){for(var r=e.toUpperCase(),n=0,i=this.favouriteRoutes.length;i>n;n++)if(this.favouriteRoutes[n].from.id.toUpperCase()===r)for(var a=0,u=this.favouriteRoutes[n].to.length;u>a;a++)if(this.favouriteRoutes[n].to[a].routeId===t){if(this.favouriteRoutes[n].to.splice(a,1),0===this.favouriteRoutes[n].to.length&&this.favouriteRoutes.splice(n,1),!o)return;o()}},t}();t.exports=r},function(t,exports,e){var o=function(){function t(){}return t.prototype.query=function(t,e,o,r){if(!e||!o)throw"URL and XPATH must be set for YQL query";if(!t.hasOwnProperty("getJSON"))throw"getJSON is expected for remote query";var n="http://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent("select * from html where url='"+e+"' and xpath='"+o)+"'&format=json&callback=?";t.getJSON(n,function(t){r&&r(t)})},t}();t.exports=o},function(t,exports,e){var o=function(){function t(){this.from={name:"",id:""},this.to=new Array,this.to.push({routeId:"",name:"",id:""})}return t}();t.exports=o}]);